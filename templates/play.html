<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>ENGL080</title>
    <!-- Styling -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700,900" rel="stylesheet">
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
    <!-- Site container -->
    <div class="index-container">
        <div class="index-container--top">
            <!-- Header -->
            <div class="index-header--container">
                <!-- Title -->
                <div class="index-title--container">
                    <div class="index-title--text">
                        Disinformation
                    </div>
                </div>
                <!-- Links -->
                <div class="index-links--container">
                    <div class="index-links--text">
                        Play
                    </div>
                    <div class="index-links--text">
                        About
                    </div>
                </div>
            </div>
            <!-- Main -->
            <div class="index-main--container">
                <div class="index-center--container">
                    <!-- Reveal container -->
                    <div class="reveal--container" id="reveal--container"></div>
                    <!-- Headline container -->
                    <div class="headline--container">
                        <div class="headline--title" id="headline--title">
                            California May Soon Unravel Controversial Nets Used To Harvest Swordfish
                        </div>
                        <div class="headline--bottom">
                            <div class="headline--meta">
                                <div class="headline--author">
                                    By <strong>Jane Smith</strong> and <strong>John Doe</strong>
                                </div>
                                <div class="headline--date">
                                    Nov. 8, 2018
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Answer container -->
                    <div class="answer--container">
                        <div class="button--primary left button--primary-answer" id="button--primary-answer" data-answer="false">Fake</div>
                        <div class="button--primary right button--primary-answer" id="button--primary-answer" data-answer="true">Real</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        async function submitAnswer(choice) {

            // 1. Reveal answer
            revealAnswer(choice);

            // 2. Sleep
            await sleep(2000);

            // 3. Change headline state
            changeHeadlineState();
    
            // 4. Change headline div
            changeHeadlineDiv();

            // 4. remove answer
            hideAnswer();

        }

        async function changeHeadlineState() {

            // Sleep for offset
            await sleep(100);

            // Get new headline
            thisHeadline = inputs.pop();

            // if (thisHeadline == undefined) {//TODO}

            // Change state
            currHeadline.answer = thisHeadline[0];
            currHeadline.text = thisHeadline[1];
            currHeadline.replacements = thisHeadline[2];

        }

        function changeHeadlineDiv() {

            // Get and edit headline div
            $("#headline--title")
                .html(`${currHeadline.text}`);

        }

        function revealAnswer(choice) {

            var thisChoice = (choice == currHeadline.answer) ? "Correct" : "Incorrect";
            var thisAnswer = (currHeadline.answer == true) ? "real" : "fake";

            // Get and edit reveal DIV
            $("#reveal--container")
                .css('visibility', 'visible')
                .html(`<b>${thisChoice}!</b>&nbsp;This headline is ${thisAnswer}.`);

        }

        function hideAnswer() {

            // Get and edit reveal DIV
            $("#reveal--container")
                .css('visibility', 'hidden')

        }

        // Global variables for keeping state
        var inputs = {{ inputs | safe }};
        
        var currHeadline = {
            "answer": false,
            "text": "California May Soon Unravel Controversial Nets Used To Harvest Swordfish",
            "replacements": null
        }

        // 
        $('.button--primary-answer').click(function() {  
            console.log($(this).data('answer'));
        });

    </script>
</body>

</html>